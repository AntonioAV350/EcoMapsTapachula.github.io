<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T5XQR9PR');</script>
<!-- End Google Tag Manager -->
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoMaps - Encuentra Lugares Cercanos</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5XQR9PR"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5530 100%);
            color: #ffffff;
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Efectos de part√≠culas flotantes */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            background: radial-gradient(circle, #4ade80 0%, #22c55e 50%, transparent 70%);
            border-radius: 50%;
            animation: float 25s infinite linear;
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.3);
        }

        .particle:nth-child(1) { width: 8px; height: 8px; left: 10%; animation-delay: 0s; }
        .particle:nth-child(2) { width: 12px; height: 12px; left: 20%; animation-delay: 3s; }
        .particle:nth-child(3) { width: 6px; height: 6px; left: 30%; animation-delay: 6s; }
        .particle:nth-child(4) { width: 10px; height: 10px; left: 40%; animation-delay: 9s; }
        .particle:nth-child(5) { width: 8px; height: 8px; left: 50%; animation-delay: 12s; }
        .particle:nth-child(6) { width: 14px; height: 14px; left: 60%; animation-delay: 15s; }
        .particle:nth-child(7) { width: 6px; height: 6px; left: 70%; animation-delay: 18s; }
        .particle:nth-child(8) { width: 10px; height: 10px; left: 80%; animation-delay: 21s; }
        .particle:nth-child(9) { width: 8px; height: 8px; left: 90%; animation-delay: 24s; }
        .particle:nth-child(10) { width: 12px; height: 12px; left: 15%; animation-delay: 27s; }

        /* Burbujas luminosas adicionales */
        .bubble {
            position: absolute;
            background: radial-gradient(circle, rgba(74, 222, 128, 0.8) 0%, rgba(34, 197, 94, 0.4) 40%, transparent 70%);
            border-radius: 50%;
            animation: bubble-float 20s infinite linear;
            box-shadow: 0 0 30px rgba(74, 222, 128, 0.5), inset 0 0 20px rgba(255, 255, 255, 0.2);
            opacity: 0.7;
        }

        .bubble:nth-child(11) { width: 15px; height: 15px; left: 5%; animation-delay: 0s; }
        .bubble:nth-child(12) { width: 20px; height: 20px; left: 25%; animation-delay: 4s; }
        .bubble:nth-child(13) { width: 10px; height: 10px; left: 45%; animation-delay: 8s; }
        .bubble:nth-child(14) { width: 25px; height: 25px; left: 65%; animation-delay: 12s; }
        .bubble:nth-child(15) { width: 12px; height: 12px; left: 85%; animation-delay: 16s; }
        .bubble:nth-child(16) { width: 18px; height: 18px; left: 35%; animation-delay: 2s; }
        .bubble:nth-child(17) { width: 8px; height: 8px; left: 55%; animation-delay: 6s; }
        .bubble:nth-child(18) { width: 22px; height: 22px; left: 75%; animation-delay: 10s; }
        .bubble:nth-child(19) { width: 14px; height: 14px; left: 95%; animation-delay: 14s; }
        .bubble:nth-child(20) { width: 16px; height: 16px; left: 15%; animation-delay: 18s; }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        @keyframes bubble-float {
            0% { 
                transform: translateY(100vh) translateX(0px) scale(0.5); 
                opacity: 0; 
            }
            10% { 
                opacity: 0.7; 
                transform: translateY(90vh) translateX(10px) scale(0.8); 
            }
            25% { 
                transform: translateY(75vh) translateX(-15px) scale(1); 
            }
            50% { 
                transform: translateY(50vh) translateX(20px) scale(1.1); 
            }
            75% { 
                transform: translateY(25vh) translateX(-10px) scale(0.9); 
            }
            90% { 
                opacity: 0.7; 
                transform: translateY(10vh) translateX(5px) scale(0.7); 
            }
            100% { 
                transform: translateY(-10vh) translateX(0px) scale(0.3); 
                opacity: 0; 
            }
        }

        /* Pantalla de bienvenida con glassmorphism */
        .welcome-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            z-index: 2;
            background: transparent;
        }

        .welcome-content {
            max-width: 700px;
            padding: 40px 20px;
            animation: slideUp 1.2s ease-out;
            position: relative;
        }

        .planet-icon {
            font-size: 12rem;
            margin-bottom: 30px;
            display: block;
            animation: float-planet 6s ease-in-out infinite;
            filter: drop-shadow(0 0 30px rgba(0, 212, 255, 0.5));
        }

        @keyframes float-planet {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(0, 212, 255, 0.5), 0 0 30px rgba(0, 212, 255, 0.3); }
            to { text-shadow: 0 0 30px rgba(0, 212, 255, 0.8), 0 0 40px rgba(0, 212, 255, 0.5); }
        }

        @keyframes glow-green-text {
            from { text-shadow: 0 0 20px rgba(134, 239, 172, 0.5), 0 0 30px rgba(134, 239, 172, 0.3); }
            to { text-shadow: 0 0 30px rgba(134, 239, 172, 0.8), 0 0 40px rgba(134, 239, 172, 0.5); }
        }

        @keyframes glow-green {
            from { box-shadow: 0 0 20px rgba(134, 239, 172, 0.4), 0 0 30px rgba(134, 239, 172, 0.3); }
            to { box-shadow: 0 0 30px rgba(134, 239, 172, 0.7), 0 0 40px rgba(134, 239, 172, 0.5); }
        }

        .welcome-title {
            font-size: 5.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 50%, #16a34a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 30px;
            text-shadow: 0 0 40px rgba(74, 222, 128, 0.5);
            letter-spacing: -0.03em;
            position: relative;
            z-index: 2;
            animation: glow 2s ease-in-out infinite alternate;
        }

        .welcome-subtitle {
            font-size: 1.4rem;
            color: rgba(255,255,255,0.8);
            margin-bottom: 50px;
            line-height: 1.7;
            font-weight: 400;
            position: relative;
            z-index: 2;
        }

        .start-btn {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: #0f2027;
            padding: 20px 50px;
            font-size: 18px;
            border-radius: 50px;
            font-weight: 700;
            border: 2px solid rgba(74, 222, 128, 0.5);
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 15px 40px rgba(74, 222, 128, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            z-index: 2;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .start-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .start-btn:hover::before {
            left: 100%;
        }

        .start-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 25px 60px rgba(74, 222, 128, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.3);
            background: linear-gradient(135deg, #6ee7b7 0%, #4ade80 100%);
            color: #0f2027;
        }

        /* Aplicaci√≥n principal */
        .main-app {
            min-height: 100vh;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5530 100%);
            position: relative;
            z-index: 2;
        }

        /* Bot√≥n de regreso simple */
        .home-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: transparent;
            color: #4ade80;
            border: none;
            padding: 8px 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            opacity: 1;
            transform: translateY(0);
        }

        .home-btn:hover {
            color: #6ee7b7;
            transform: scale(1.1);
        }

        /* Navegaci√≥n con efectos modernos */
        .nav-tabs {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
            padding: 15px 20px;
            display: flex;
            gap: 8px;
            justify-content: center;
            border-bottom: 1px solid rgba(0, 212, 255, 0.3);
            margin-bottom: 30px;
            border-radius: 15px;
        }

        .nav-tab {
            padding: 12px 24px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: transparent;
            border-radius: 25px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            color: rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .nav-tab.active::before {
            opacity: 1;
        }

        .nav-tab.active {
            color: #0f2027;
            box-shadow: 0 8px 25px rgba(74, 222, 128, 0.6);
            border-color: #4ade80;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(74, 222, 128, 0.1);
            color: #4ade80;
            border-color: rgba(74, 222, 128, 0.5);
        }

        /* Contenedor principal */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Secci√≥n de b√∫squeda flotante */
        .search-section {
            background: transparent;
            padding: 0;
            margin-bottom: 30px;
        }

        .search-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 300px;
            padding: 15px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            font-size: 16px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
            color: #ffffff;
            transition: all 0.3s ease;
            outline: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .search-input:focus {
            border-color: #4ade80;
            box-shadow: 0 0 0 4px rgba(74, 222, 128, 0.2), 0 5px 15px rgba(0, 0, 0, 0.3);
            background: rgba(0, 0, 0, 0.8);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 25px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: #0f2027;
            box-shadow: 0 5px 15px rgba(74, 222, 128, 0.4);
            border: 2px solid rgba(74, 222, 128, 0.5);
        }

        .btn-primary:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(74, 222, 128, 0.6);
            background: linear-gradient(135deg, #6ee7b7 0%, #4ade80 100%);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: #0f2027;
            border: 2px solid rgba(74, 222, 128, 0.5);
            box-shadow: 0 5px 15px rgba(74, 222, 128, 0.4);
        }

        .btn-secondary:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(74, 222, 128, 0.6);
            background: linear-gradient(135deg, #6ee7b7 0%, #4ade80 100%);
        }

        /* Filtros de categor√≠a con efectos modernos */
        .category-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .category-btn {
            padding: 15px 20px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            background: rgba(255, 255, 255, 0.8);
            color: #64748b;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .category-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .category-btn:hover::before {
            opacity: 0.1;
        }

        .category-btn.active::before {
            opacity: 1;
        }

        .category-btn.active {
            color: white;
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .green-glow {
            /* Animaci√≥n removida */
        }

        /* Logo de la aplicaci√≥n */
        .app-logo {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        .logo-title {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 50%, #16a34a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
            text-shadow: 0 0 40px rgba(74, 222, 128, 0.5);
            letter-spacing: -0.02em;
            animation: glow 2s ease-in-out infinite alternate;
        }

        /* Botones flotantes debajo del buscador - MEJORADOS */
        .floating-categories-below {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin: 30px 0;
            padding: 0 20px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }

        .floating-btn-below {
            padding: 12px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
            color: #ffffff;
            border-radius: 25px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            white-space: nowrap;
            min-width: fit-content;
            flex: 0 0 auto;
        }

        @keyframes float-gentle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .floating-btn-below::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .floating-btn-below:hover {
            transform: scale(1.1) translateY(-3px);
            box-shadow: 0 10px 25px rgba(74, 222, 128, 0.4);
            border-color: rgba(74, 222, 128, 0.6);
        }

        .floating-btn-below:hover::before {
            opacity: 0.2;
        }

        .floating-btn-below.active::before {
            opacity: 1;
        }

        .floating-btn-below.active {
            color: #0f2027;
            border-color: #4ade80;
            box-shadow: 0 8px 20px rgba(74, 222, 128, 0.4);
        }

        /* Mapa con efectos modernos - ACTUALIZADO PARA LEAFLET */
        .map-container {
            height: 500px;
            background: #f0f0f0;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 3px solid rgba(74, 222, 128, 0.3);
        }

        #map {
            height: 100%;
            width: 100%;
            border-radius: 17px;
        }

        /* Personalizar controles de Leaflet */
        .leaflet-control-zoom a {
            background-color: rgba(74, 222, 128, 0.9) !important;
            color: #0f2027 !important;
            border: none !important;
            font-weight: bold !important;
        }

        .leaflet-control-zoom a:hover {
            background-color: rgba(74, 222, 128, 1) !important;
        }

        /* Personalizar popup */
        .leaflet-popup-content-wrapper {
            background: rgba(15, 32, 39, 0.95) !important;
            color: white !important;
            border-radius: 15px !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5) !important;
            border: 2px solid rgba(74, 222, 128, 0.5) !important;
        }

        .leaflet-popup-content {
            margin: 15px !important;
            font-family: 'Inter', sans-serif !important;
        }

        .leaflet-popup-tip {
            background: rgba(15, 32, 39, 0.95) !important;
            border: 2px solid rgba(74, 222, 128, 0.5) !important;
            border-top: none !important;
            border-right: none !important;
        }

        .popup-content h3 {
            color: #4ade80 !important;
            margin-bottom: 10px !important;
            font-size: 1.1rem !important;
        }

        .popup-content p {
            margin: 5px 0 !important;
            font-size: 0.9rem !important;
        }

        .popup-content .category-tag {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: #0f2027;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-block;
            margin-bottom: 8px;
        }

        /* Cards de lugares con glassmorphism */
        .places-grid {
            display: grid;
            gap: 20px;
        }

        .place-card {
            background: rgba(134, 239, 172, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(134, 239, 172, 0.4);
            border-radius: 20px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(134, 239, 172, 0.3);
        }

        .place-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .place-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(134, 239, 172, 0.5);
            background: rgba(134, 239, 172, 1);
        }

        .place-card:hover::before {
            transform: scaleX(1);
        }

        .place-name {
            font-size: 1.25rem;
            font-weight: 700;
            color: #0f0f23;
            margin-bottom: 8px;
        }

        .place-category {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
            margin-bottom: 10px;
        }

        .place-info {
            color: rgba(15, 15, 35, 0.8);
            margin-bottom: 5px;
            font-size: 14px;
        }

        .place-distance {
            color: #0f0f23;
            font-weight: 500;
        }

        .directions-info {
            background: rgba(74, 222, 128, 0.2);
            border-left: 3px solid #4ade80;
            padding: 8px 12px;
            margin-top: 10px;
            border-radius: 8px;
            font-size: 13px;
            font-style: italic;
            color: #0f0f23 !important;
        }

        /* Secci√≥n ambiental con efectos especiales */
        .env-section {
            background: linear-gradient(135deg, #86efac 0%, #6ee7b7 50%, #34d399 100%);
            border-radius: 25px;
            padding: 40px;
            color: #0f0f23;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(134, 239, 172, 0.4);
        }

        /* Bot√≥n de atr√°s en la secci√≥n ambiental */
        .env-back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(15, 15, 35, 0.2);
            color: #0f0f23;
            border: 2px solid rgba(15, 15, 35, 0.3);
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 25px;
            transition: all 0.3s ease;
            z-index: 10;
            backdrop-filter: blur(10px);
        }

        .env-back-btn:hover {
            background: rgba(15, 15, 35, 0.3);
            border-color: rgba(15, 15, 35, 0.5);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(15, 15, 35, 0.2);
        }

        .env-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="40" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="40" cy="80" r="1" fill="rgba(255,255,255,0.1)"/></svg>');
            opacity: 0.3;
        }

        .env-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            position: relative;
            z-index: 2;
            max-width: 900px;
            margin: 0 auto;
            justify-items: center;
        }

        .env-card {
            background: rgba(15, 15, 35, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(15, 15, 35, 0.2);
            transition: all 0.3s ease;
            width: 100%;
            max-width: 280px;
        }

        .env-card:hover {
            transform: translateY(-5px);
            background: rgba(15, 15, 35, 0.25);
        }

        .env-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        .env-card h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .env-tip {
            background: rgba(15, 15, 35, 0.2);
            border-left: 4px solid rgba(15, 15, 35, 0.5);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 14px;
        }

        /* Loading con efectos modernos */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(74, 222, 128, 0.3);
            border-top: 3px solid #4ade80;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Estados ocultos */
        .hidden {
            display: none;
        }

        /* Responsive - Mantener EXACTAMENTE el dise√±o desktop */
        @media (max-width: 768px) {
            /* Mantener tama√±os exactos del desktop */
            .welcome-title {
                font-size: 5.5rem;
            }

            .planet-icon {
                font-size: 12rem;
            }

            .welcome-subtitle {
                font-size: 1.4rem;
                padding: 0 20px;
            }

            .start-btn {
                padding: 20px 50px;
                font-size: 18px;
            }

            .main-content {
                padding: 30px 20px;
            }

            .search-bar {
                display: flex;
                gap: 15px;
                margin-bottom: 25px;
                flex-wrap: nowrap;
            }

            .search-input {
                flex: 1;
                max-width: 200px;
                min-width: 150px;
                padding: 15px 20px;
                font-size: 16px;
            }

            .btn {
                padding: 15px 20px;
                font-size: 15px;
                min-width: 80px;
            }

            .nav-tabs {
                display: flex;
                gap: 8px;
                padding: 15px 20px;
                margin-bottom: 30px;
                justify-content: center;
            }

            .nav-tab {
                padding: 12px 24px;
                font-size: 15px;
            }

            .floating-categories-below {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                justify-items: center;
                margin: 30px 0;
                padding: 0 20px;
                max-width: 100%;
                margin-left: auto;
                margin-right: auto;
            }

            .floating-btn-below {
                padding: 10px 15px;
                font-size: 11px;
                width: 100%;
                max-width: 160px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .map-container {
                height: 400px;
                margin-bottom: 30px;
            }

            .place-card {
                padding: 25px;
            }

            .place-name {
                font-size: 1.25rem;
            }

            .place-info {
                font-size: 14px;
            }

            .env-section {
                padding: 40px;
            }

            .env-grid {
                display: grid;
                grid-template-columns: 1fr;
                gap: 20px;
                max-width: 100%;
            }

            .env-card {
                padding: 20px;
                max-width: none;
            }

            .env-card h3 {
                font-size: 1.3rem;
                margin-bottom: 15px;
            }

            .env-card p {
                font-size: 14px;
                line-height: 1.5;
                margin-bottom: 15px;
            }

            .env-tip {
                padding: 15px;
                font-size: 13px;
                margin-top: 15px;
            }

            .env-icon {
                font-size: 2.5rem;
                margin-bottom: 15px;
            }
        }

        @media (max-width: 480px) {
            /* Mantener tama√±os exactos incluso en m√≥viles peque√±os */
            .welcome-title {
                font-size: 5.5rem;
            }

            .planet-icon {
                font-size: 12rem;
            }

            .welcome-subtitle {
                font-size: 1.4rem;
                padding: 0 20px;
            }

            .start-btn {
                padding: 20px 50px;
                font-size: 18px;
            }

            .search-bar {
                display: flex;
                gap: 8px;
                flex-wrap: nowrap;
                align-items: stretch;
            }

            .search-input {
                flex: 1;
                max-width: 200px;
                min-width: 150px;
                padding: 12px 16px;
                font-size: 14px;
            }

            .btn {
                padding: 12px 16px;
                font-size: 13px;
                white-space: nowrap;
                flex-shrink: 0;
                min-width: 80px;
            }

            .nav-tabs {
                display: flex;
                gap: 8px;
                padding: 15px 20px;
                justify-content: center;
                flex-wrap: wrap;
            }

            .nav-tab {
                padding: 12px 24px;
                font-size: 15px;
            }

            .floating-categories-below {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                justify-items: center;
                margin: 30px 0;
                padding: 0 20px;
                max-width: 100%;
                margin-left: auto;
                margin-right: auto;
            }

            .floating-btn-below {
                padding: 10px 12px;
                font-size: 10px;
                width: 100%;
                max-width: 150px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .map-container {
                height: 400px;
            }

            .env-section {
                padding: 40px;
            }

            .env-grid {
                display: grid;
                grid-template-columns: 1fr;
                gap: 20px;
                max-width: 100%;
            }

            .env-card {
                padding: 20px;
                max-width: none;
            }

            .env-card h3 {
                font-size: 1.3rem;
                margin-bottom: 15px;
            }

            .env-card p {
                font-size: 14px;
                line-height: 1.5;
                margin-bottom: 15px;
            }

            .env-tip {
                padding: 15px;
                font-size: 13px;
                margin-top: 15px;
            }

            .env-icon {
                font-size: 2.5rem;
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Part√≠culas flotantes -->
    <div class="particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>

    <!-- Pantalla de Bienvenida -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <div class="planet-icon">üåç</div>
            <h1 class="welcome-title">EcoMaps</h1>
            <p class="welcome-subtitle">Encuentra centros de reciclaje cercanos y contribuye a un planeta m√°s sostenible</p>
            <button class="start-btn" onclick="startApp()">
                üå± Comenzar Exploraci√≥n
            </button>
        </div>
    </div>

    <!-- Aplicaci√≥n Principal -->
    <div class="main-app hidden" id="mainApp">
        <!-- Bot√≥n de regreso -->
        <button class="home-btn" id="homeBtn" onclick="goHome()">
            ‚Üê Inicio
        </button>

        <div class="main-content">
            <!-- Secci√≥n de Lugares -->
            <div id="lugaresContent">

                <!-- Logo -->
                <div class="app-logo">
                    <h1 class="logo-title">EcoMaps</h1>
                </div>



                <!-- Botones flotantes de categor√≠a -->
                <div class="floating-categories-below">
                    <button class="floating-btn-below active" onclick="filterCategory('reciclaje')">‚ôªÔ∏è Todos los Centros</button>
                    <button class="floating-btn-below" onclick="filterCategory('electronico')">üì± Electr√≥nicos</button>
                    <button class="floating-btn-below" onclick="filterCategory('pilas')">üîã Pilas y Bater√≠as</button>
                    <button class="floating-btn-below" onclick="filterCategory('textiles')">üëï Textiles</button>
                    <button class="floating-btn-below" onclick="filterCategory('papel')">üìÑ Papel y Cart√≥n</button>
                    <button class="floating-btn-below" onclick="filterCategory('plastico')">ü•§ Pl√°sticos</button>
                </div>

                <!-- Mapa Real con Leaflet -->
                <div class="map-container">
                    <div id="map"></div>
                </div>

                <!-- Navegaci√≥n -->
                <div class="nav-tabs">
                    <button class="nav-tab active" id="lugaresTab" onclick="showTab('lugares')">
                        üìç Lugares Cercanos
                    </button>
                    <button class="nav-tab" id="ambienteTab" onclick="showTab('ambiente')">
                        üå± Info Ambiental
                    </button>
                    <button class="nav-tab" onclick="getCurrentLocation()">
                        üìç Mi Ubicaci√≥n
                    </button>
                </div>

                <!-- Loading -->
                <div class="loading" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p>Buscando lugares cercanos...</p>
                </div>

                <!-- Lista de lugares -->
                <div class="places-grid" id="placesList">
                    <div class="place-card" onclick="focusOnPlace(1)">
                        <div class="place-category">Centro General</div>
                        <div class="place-name">‚ôªÔ∏è EcoRecicla Centro</div>
                        <div class="place-info">üìç Av. Sostenible 123, Centro</div>
                        <div class="place-distance">üìè 0.3 km de distancia</div>
                        <div class="place-info">üóÇÔ∏è Papel, Pl√°stico, Vidrio, Metal</div>
                        <div class="place-info">‚≠ê 4.7 (89 rese√±as)</div>
                    </div>

                    <div class="place-card" onclick="focusOnPlace(2)">
                        <div class="place-category">Centro General</div>
                        <div class="place-name">üóÇÔ∏è Punto Verde Municipal</div>
                        <div class="place-info">üìç Plaza Ecol√≥gica 45, Norte</div>
                        <div class="place-distance">üìè 0.6 km de distancia</div>
                        <div class="place-info">üåü Todos los materiales</div>
                        <div class="place-info">‚≠ê 4.8 (156 rese√±as)</div>
                    </div>

                    <div class="place-card" onclick="focusOnPlace(3)">
                        <div class="place-category">Electr√≥nicos</div>
                        <div class="place-name">üì± Recicla Tech</div>
                        <div class="place-info">üìç Calle Tecnolog√≠a 234, Sur</div>
                        <div class="place-distance">üìè 0.9 km de distancia</div>
                        <div class="place-info">üì± Celulares, Computadoras, Tablets</div>
                        <div class="place-info">‚≠ê 4.5 (67 rese√±as)</div>
                    </div>

                    <div class="place-card" onclick="focusOnPlace(4)">
                        <div class="place-category">Pilas</div>
                        <div class="place-name">üîã Centro de Pilas y Bater√≠as</div>
                        <div class="place-info">üìç Av. Limpia 567, Este</div>
                        <div class="place-distance">üìè 1.1 km de distancia</div>
                        <div class="place-info">üîã Pilas, Bater√≠as, Acumuladores</div>
                        <div class="place-info">‚≠ê 4.6 (134 rese√±as)</div>
                    </div>

                    <div class="place-card" onclick="focusOnPlace(5)">
                        <div class="place-category">Textiles</div>
                        <div class="place-name">üëï Textiles Sostenibles</div>
                        <div class="place-info">üìç Calle Ropa 890, Oeste</div>
                        <div class="place-distance">üìè 1.4 km de distancia</div>
                        <div class="place-info">üëï Ropa, Zapatos, Telas</div>
                        <div class="place-info">‚≠ê 4.4 (98 rese√±as)</div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n Ambiental -->
            <div id="ambienteContent" class="hidden">
                <div class="env-section">
                    <!-- Bot√≥n de atr√°s dentro de la secci√≥n verde -->
                    <button class="env-back-btn" onclick="showTab('lugares')">
                        ‚Üê Atr√°s
                    </button>
                    
                    <div style="text-align: center; margin-bottom: 50px; margin-top: 30px;">
                        <h2 style="font-size: 2.5rem; margin: 0;">üå± Informaci√≥n Ambiental</h2>
                    </div>
                    
                    <div class="env-grid">
                        <div class="env-card">
                            <div class="env-icon">‚ôªÔ∏è</div>
                            <h3>Reciclaje Efectivo</h3>
                            <p>El reciclaje reduce hasta un 70% los residuos que van a vertederos. Separar correctamente papel, pl√°stico, vidrio y org√°nicos marca la diferencia para nuestro planeta.</p>
                            <div class="env-tip">üí° <strong>Tip:</strong> Lava los envases antes de reciclar para mejorar la calidad del proceso</div>
                        </div>

                        <div class="env-card">
                            <div class="env-icon">üåç</div>
                            <h3>Cambio Clim√°tico</h3>
                            <p>Las actividades humanas han aumentado la temperatura global en 1.1¬∞C. Peque√±as acciones como usar transporte p√∫blico ayudan significativamente a reducir emisiones.</p>
                            <div class="env-tip">üí° <strong>Tip:</strong> Camina o usa bicicleta para distancias cortas</div>
                        </div>

                        <div class="env-card">
                            <div class="env-icon">üíß</div>
                            <h3>Conservaci√≥n del Agua</h3>
                            <p>Solo el 3% del agua del planeta es dulce. Cerrar el grifo mientras te cepillas los dientes ahorra hasta 12 litros por minuto.</p>
                            <div class="env-tip">üí° <strong>Tip:</strong> Repara las fugas inmediatamente para evitar desperdicios</div>
                        </div>

                        <div class="env-card">
                            <div class="env-icon">üå≥</div>
                            <h3>Importancia de los √Årboles</h3>
                            <p>Un √°rbol maduro absorbe 22kg de CO‚ÇÇ al a√±o y produce ox√≠geno para 2 personas. Los bosques urbanos reducen la temperatura hasta 5¬∞C.</p>
                            <div class="env-tip">üí° <strong>Tip:</strong> Planta √°rboles nativos en tu comunidad</div>
                        </div>

                        <div class="env-card">
                            <div class="env-icon">‚ö°</div>
                            <h3>Energ√≠a Renovable</h3>
                            <p>La energ√≠a solar y e√≥lica son ahora m√°s baratas que los combustibles f√≥siles. Cambiar a LED reduce el consumo el√©ctrico en 80%.</p>
                            <div class="env-tip">üí° <strong>Tip:</strong> Desconecta aparatos en standby para ahorrar energ√≠a</div>
                        </div>

                        <div class="env-card">
                            <div class="env-icon">üêù</div>
                            <h3>Biodiversidad</h3>
                            <p>Las abejas polinizan el 75% de nuestros alimentos. Crear jardines con plantas nativas ayuda a preservar especies locales y el ecosistema.</p>
                            <div class="env-tip">üí° <strong>Tip:</strong> Evita pesticidas en tu jard√≠n para proteger a los polinizadores</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        let currentCategory = 'reciclaje';
        let userLocation = null;
        let map = null;
        let markers = [];
        let userMarker = null;

        // Funci√≥n para generar datos locales basados en la ubicaci√≥n del usuario
        function generateLocalPlacesData(userLat, userLng, userRegion) {
            // Verificar si el usuario est√° en Tapachula
            const isTapachula = userRegion.city && userRegion.city.toLowerCase().includes('tapachula');
            
            if (isTapachula) {
                // Lugares reales de Tapachula
                return getTapachulaPlaces(userLat, userLng);
            }
            
            // Datos gen√©ricos para otras ciudades
            const baseNames = [
                "‚ôªÔ∏è EcoRecicla",
                "üóÇÔ∏è Punto Verde",
                "üå± Centro Sostenible",
                "‚ôªÔ∏è Recicla F√°cil",
                "üåç EcoPoint"
            ];
            
            const categories = ["Centro General", "Electr√≥nicos", "Pilas", "Textiles", "Papel", "Pl√°sticos"];
            const materials = {
                "Centro General": "Papel, Pl√°stico, Vidrio, Metal",
                "Electr√≥nicos": "Celulares, Computadoras, Tablets",
                "Pilas": "Pilas, Bater√≠as, Acumuladores",
                "Textiles": "Ropa, Zapatos, Telas",
                "Papel": "Papel, Cart√≥n, Peri√≥dicos, Revistas",
                "Pl√°sticos": "Botellas PET, Envases, Bolsas"
            };
            
            const places = [];
            
            // Generar 5-8 lugares cercanos dentro de un radio de 5km
            const numPlaces = Math.floor(Math.random() * 4) + 5;
            
            for (let i = 0; i < numPlaces; i++) {
                // Generar coordenadas cercanas (dentro de 5km)
                const angle = Math.random() * 2 * Math.PI;
                const distance = Math.random() * 0.05; // ~5km en grados
                const lat = userLat + (distance * Math.cos(angle));
                const lng = userLng + (distance * Math.sin(angle));
                
                const category = categories[Math.floor(Math.random() * categories.length)];
                const baseName = baseNames[Math.floor(Math.random() * baseNames.length)];
                
                // Crear direcci√≥n local usando la regi√≥n del usuario
                const streetNumber = Math.floor(Math.random() * 999) + 1;
                const streetNames = ["Principal", "Central", "Verde", "Sostenible", "Ecol√≥gica", "Limpia"];
                const streetName = streetNames[Math.floor(Math.random() * streetNames.length)];
                const address = `${streetName} ${streetNumber}, ${userRegion.city || userRegion.state}`;
                
                const realDistance = calculateDistance(userLat, userLng, lat, lng);
                
                places.push({
                    name: `${baseName} ${userRegion.city || userRegion.state}`,
                    category: category,
                    address: address,
                    distance: `${realDistance.toFixed(1)} km`,
                    rating: (Math.random() * 1.5 + 3.5).toFixed(1),
                    reviews: Math.floor(Math.random() * 200) + 20,
                    materials: materials[category],
                    lat: lat,
                    lng: lng,
                    directions: `Desde el centro de ${userRegion.city || userRegion.state}, tomar ${streetName} hacia el ${getRandomDirection()}`
                });
            }
            
            // Ordenar por distancia
            return places.sort((a, b) => parseFloat(a.distance) - parseFloat(b.distance));
        }

        // Lugares reales de Tapachula, Chiapas
        function getTapachulaPlaces(userLat, userLng) {
            const tapachulaPlaces = [
                {
                    name: "üè™ Mercado San Juan - Secci√≥n Usados",
                    category: "Centro General",
                    address: "Calle Central Norte, Mercado San Juan, Centro, Tapachula",
                    lat: 14.9067,
                    lng: -92.2627,
                    materials: "Ropa usada, Electrodom√©sticos, Muebles, Herramientas",
                    rating: "4.2",
                    reviews: "87",
                    directions: "Desde el Parque Central, caminar 3 cuadras al norte por la Calle Central Norte. El mercado est√° frente a la Iglesia San Agust√≠n."
                },
                {
                    name: "‚ôªÔ∏è Chatarrera El Soconusco",
                    category: "Centro General",
                    address: "Av. Central Poniente #145, Col. Centro, Tapachula",
                    lat: 14.9045,
                    lng: -92.2655,
                    materials: "Metal, Cobre, Aluminio, Fierro, Bater√≠as de auto",
                    rating: "4.5",
                    reviews: "134",
                    directions: "Desde el Parque Central, tomar Av. Central Poniente hacia el oeste, pasar 2 sem√°foros. Est√° junto a la ferreter√≠a La Frontera."
                },
                {
                    name: "üì± Compra-Venta de Celulares TGZ",
                    category: "Electr√≥nicos",
                    address: "Calle 5a Norte #23, entre Central y 1a Poniente, Centro",
                    lat: 14.9078,
                    lng: -92.2640,
                    materials: "Celulares, Tablets, Computadoras, Accesorios",
                    rating: "4.3",
                    reviews: "156",
                    directions: "Desde el Parque Central, caminar por 5a Calle Norte hacia el poniente, est√° a media cuadra, local con letrero azul."
                },
                {
                    name: "üëï Ropa Americana La Frontera",
                    category: "Textiles",
                    address: "Calle 3a Sur #67, Col. Centro, Tapachula",
                    lat: 14.9025,
                    lng: -92.2618,
                    materials: "Ropa americana, Zapatos usados, Bolsas, Accesorios",
                    rating: "4.1",
                    reviews: "203",
                    directions: "Desde el Parque Central, ir hacia el sur por Calle Central, girar a la izquierda en 3a Sur. Est√° cerca del Banco Azteca."
                },
                {
                    name: "üîß Refaccionaria y Compra-Venta El Mec√°nico",
                    category: "Centro General",
                    address: "Carretera Costera Km 2.5, Col. Las Granjas, Tapachula",
                    lat: 14.8987,
                    lng: -92.2789,
                    materials: "Refacciones usadas, Motores, Transmisiones, Llantas",
                    rating: "4.4",
                    reviews: "98",
                    directions: "Tomar la Carretera Costera hacia Puerto Madero, a 2.5 km del centro. Est√° en la colonia Las Granjas, local grande con patio."
                },
                {
                    name: "üìö Librer√≠a de Viejo Don Quijote",
                    category: "Papel",
                    address: "Calle 7a Norte #45, entre 2a y 4a Poniente, Centro",
                    lat: 14.9089,
                    lng: -92.2671,
                    materials: "Libros usados, Revistas, Peri√≥dicos, Documentos antiguos",
                    rating: "4.6",
                    reviews: "67",
                    directions: "Desde el Parque Central, caminar por 7a Norte hacia el poniente. Est√° frente a la Escuela Primaria Benito Ju√°rez."
                },
                {
                    name: "üè† Muebler√≠a Segunda Mano El Hogar",
                    category: "Centro General",
                    address: "Av. 4a Norte #234, Col. Xamaipak, Tapachula",
                    lat: 14.9156,
                    lng: -92.2598,
                    materials: "Muebles usados, Electrodom√©sticos, Colchones, Decoraci√≥n",
                    rating: "4.0",
                    reviews: "112",
                    directions: "Tomar Av. 4a Norte desde el centro hacia el oriente, pasar el puente del r√≠o Coat√°n. Est√° en la colonia Xamaipak."
                },
                {
                    name: "üîã Centro de Acopio Municipal",
                    category: "Pilas",
                    address: "Palacio Municipal, Calle Central Norte s/n, Centro",
                    lat: 14.9072,
                    lng: -92.2635,
                    materials: "Pilas, Bater√≠as, Focos ahorradores, Electr√≥nicos peque√±os",
                    rating: "3.8",
                    reviews: "45",
                    directions: "En el Palacio Municipal, frente al Parque Central. Entrar por la puerta principal y preguntar por el √°rea de acopio."
                },
                {
                    name: "ü•§ Recicladora PET Soconusco",
                    category: "Pl√°sticos",
                    address: "Calle 15a Sur #123, Col. Loma Bonita, Tapachula",
                    lat: 14.8934,
                    lng: -92.2456,
                    materials: "Botellas PET, Envases pl√°sticos, Bolsas, Contenedores",
                    rating: "4.2",
                    reviews: "89",
                    directions: "Tomar transporte hacia la Col. Loma Bonita, bajar en 15a Sur. Est√° cerca del Centro de Salud de la colonia."
                },
                {
                    name: "üõí Tianguis de los S√°bados - Usados",
                    category: "Centro General",
                    address: "Explanada del Estadio Municipal, S√°bados 6:00-14:00",
                    lat: 14.9123,
                    lng: -92.2712,
                    materials: "Variedad de art√≠culos usados, Ropa, Electrodom√©sticos, Herramientas",
                    rating: "4.3",
                    reviews: "234",
                    directions: "Tomar transporte hacia el Estadio Municipal. El tianguis se instala los s√°bados en la explanada principal desde las 6:00 AM."
                }
            ];

            // Calcular distancias reales desde la ubicaci√≥n del usuario
            return tapachulaPlaces.map(place => ({
                ...place,
                distance: `${calculateDistance(userLat, userLng, place.lat, place.lng).toFixed(1)} km`
            })).sort((a, b) => parseFloat(a.distance) - parseFloat(b.distance));
        }

        function getRandomDirection() {
            const directions = ["norte", "sur", "este", "oeste", "noreste", "noroeste", "sureste", "suroeste"];
            return directions[Math.floor(Math.random() * directions.length)];
        }

        // Datos de centros de reciclaje - SOLO COMO FALLBACK
        const placesData = {
            reciclaje: [],
            electronico: [],
            pilas: [],
            textiles: [],
            papel: [],
            plastico: []
        };

        // Inicializar mapa
        function initMap() {
            // Crear mapa centrado en Buenos Aires
            map = L.map('map').setView([-34.6037, -58.3816], 13);

            // Agregar capa de mapa (OpenStreetMap)
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);

            // Agregar marcadores iniciales
            addMarkersToMap(placesData.reciclaje);
        }

        // Agregar marcadores al mapa
        function addMarkersToMap(places) {
            // Limpiar marcadores existentes
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            // Agregar nuevos marcadores
            places.forEach((place, index) => {
                // Crear icono personalizado seg√∫n categor√≠a
                const iconColor = getIconColor(place.category);
                
                const customIcon = L.divIcon({
                    html: `<div style="
                        background: ${iconColor};
                        width: 25px;
                        height: 25px;
                        border-radius: 50% 50% 50% 0;
                        transform: rotate(-45deg);
                        border: 3px solid white;
                        box-shadow: 0 3px 10px rgba(0,0,0,0.3);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 12px;
                    "></div>`,
                    className: 'custom-marker',
                    iconSize: [25, 25],
                    iconAnchor: [12, 25]
                });

                const marker = L.marker([place.lat, place.lng], { icon: customIcon })
                    .addTo(map)
                    .bindPopup(`
                        <div class="popup-content">
                            <div class="category-tag">${place.category}</div>
                            <h3>${place.name}</h3>
                            <p><strong>üìç</strong> ${place.address}</p>
                            <p><strong>üìè</strong> ${place.distance} de distancia</p>
                            <p><strong>üóÇÔ∏è</strong> ${place.materials}</p>
                            <p><strong>‚≠ê</strong> ${place.rating} (${place.reviews} rese√±as)</p>
                            ${place.directions ? `<p style="background: rgba(74, 222, 128, 0.2); padding: 8px; border-radius: 5px; margin-top: 8px; font-size: 0.85rem;"><strong>üö∂‚Äç‚ôÇÔ∏è</strong> ${place.directions}</p>` : ''}
                        </div>
                    `);

                markers.push(marker);

                // Agregar evento click para enfocar en la tarjeta
                marker.on('click', () => {
                    focusOnPlace(index + 1);
                });
            });
        }

        // Obtener color del icono seg√∫n categor√≠a
        function getIconColor(category) {
            const colors = {
                'Centro General': 'linear-gradient(135deg, #4ade80, #22c55e)',
                'Electr√≥nicos': 'linear-gradient(135deg, #3b82f6, #1d4ed8)',
                'Pilas': 'linear-gradient(135deg, #f59e0b, #d97706)',
                'Textiles': 'linear-gradient(135deg, #ec4899, #be185d)',
                'Papel': 'linear-gradient(135deg, #8b5cf6, #7c3aed)',
                'Pl√°sticos': 'linear-gradient(135deg, #06b6d4, #0891b2)'
            };
            return colors[category] || 'linear-gradient(135deg, #4ade80, #22c55e)';
        }

        async function searchPlaces() {
            const searchTerm = document.getElementById('searchInput').value.trim();
            
            // Verificar que el usuario haya compartido su ubicaci√≥n primero
            if (!userLocation) {
                showLocationRequiredMessage();
                return;
            }
            
            showLoading();
            
            try {
                if (searchTerm) {
                    // Obtener informaci√≥n del estado/regi√≥n del usuario
                    const userRegion = await getUserRegionInfo(userLocation.lat, userLocation.lng);
                    
                    // Buscar solo dentro del estado/regi√≥n del usuario
                    const geocodeResults = await geocodeAddressInRegion(searchTerm, userRegion);
                    
                    if (geocodeResults.length > 0) {
                        // Filtrar resultados para que est√©n dentro de un radio razonable (50km)
                        const nearbyResults = geocodeResults.filter(location => {
                            const distance = calculateDistance(userLocation.lat, userLocation.lng, location.lat, location.lng);
                            return distance <= 50; // M√°ximo 50km de distancia
                        });
                        
                        if (nearbyResults.length > 0) {
                            const location = nearbyResults[0];
                            
                            // Centrar mapa en la ubicaci√≥n buscada
                            map.setView([location.lat, location.lng], 15);
                            
                            // Agregar marcador temporal para la b√∫squeda
                            if (window.searchMarker) {
                                map.removeLayer(window.searchMarker);
                            }
                            
                            const searchIcon = L.divIcon({
                                html: `<div style="
                                    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
                                    width: 25px;
                                    height: 25px;
                                    border-radius: 50% 50% 50% 0;
                                    transform: rotate(-45deg);
                                    border: 3px solid white;
                                    box-shadow: 0 3px 10px rgba(0,0,0,0.3);
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 12px;
                                "></div>`,
                                className: 'search-marker',
                                iconSize: [25, 25],
                                iconAnchor: [12, 25]
                            });
                            
                            window.searchMarker = L.marker([location.lat, location.lng], { icon: searchIcon })
                                .addTo(map)
                                .bindPopup(`üîç ${location.display_name}`)
                                .openPopup();
                            
                            // Buscar lugares cercanos a esta ubicaci√≥n
                            const nearbyPlaces = await findNearbyPlaces(location.lat, location.lng, 5000);
                            
                            if (nearbyPlaces.length > 0) {
                                displayPlaces(nearbyPlaces);
                                addMarkersToMap(nearbyPlaces);
                            } else {
                                showNoResultsMessage(searchTerm);
                            }
                        } else {
                            showOutOfRangeMessage(searchTerm);
                        }
                    } else {
                        showNoResultsMessage(searchTerm);
                    }
                } else {
                    // Sin t√©rmino de b√∫squeda, mostrar lugares cercanos a la ubicaci√≥n actual
                    const nearbyPlaces = await findNearbyPlaces(userLocation.lat, userLocation.lng, 10000);
                    
                    if (nearbyPlaces.length > 0) {
                        displayPlaces(nearbyPlaces);
                        addMarkersToMap(nearbyPlaces);
                    } else {
                        // Fallback con datos simulados pero con distancias reales
                        const placesWithRealDistances = placesData[currentCategory].map(place => ({
                            ...place,
                            distance: `${calculateDistance(userLocation.lat, userLocation.lng, place.lat, place.lng).toFixed(1)} km`
                        })).sort((a, b) => parseFloat(a.distance) - parseFloat(b.distance));
                        
                        displayPlaces(placesWithRealDistances);
                        addMarkersToMap(placesWithRealDistances);
                    }
                }
            } catch (error) {
                console.error('Error en b√∫squeda:', error);
                showErrorMessage();
            }
            
            hideLoading();
        }

        // Obtener informaci√≥n de la regi√≥n/estado del usuario
        async function getUserRegionInfo(lat, lng) {
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&addressdetails=1`);
                const data = await response.json();
                
                return {
                    country: data.address?.country || '',
                    state: data.address?.state || data.address?.region || '',
                    city: data.address?.city || data.address?.town || data.address?.village || '',
                    countryCode: data.address?.country_code || ''
                };
            } catch (error) {
                console.error('Error obteniendo regi√≥n del usuario:', error);
                return { country: '', state: '', city: '', countryCode: '' };
            }
        }

        // Geocodificar direcci√≥n limitada a la regi√≥n del usuario
        async function geocodeAddressInRegion(address, userRegion) {
            try {
                // Construir query de b√∫squeda limitada a la regi√≥n del usuario
                let searchQuery = address;
                if (userRegion.state) {
                    searchQuery += `, ${userRegion.state}`;
                }
                if (userRegion.country) {
                    searchQuery += `, ${userRegion.country}`;
                }
                
                const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(searchQuery)}&limit=10&addressdetails=1&countrycodes=${userRegion.countryCode}`);
                const data = await response.json();
                
                // Filtrar resultados que est√©n en el mismo estado/regi√≥n
                const filteredResults = data.filter(item => {
                    const itemState = item.address?.state || item.address?.region || '';
                    return itemState.toLowerCase().includes(userRegion.state.toLowerCase()) || 
                           userRegion.state.toLowerCase().includes(itemState.toLowerCase());
                });
                
                return filteredResults.map(item => ({
                    lat: parseFloat(item.lat),
                    lng: parseFloat(item.lon),
                    display_name: item.display_name,
                    address: item.address
                }));
            } catch (error) {
                console.error('Error en geocodificaci√≥n regional:', error);
                return [];
            }
        }

        // Geocodificar direcci√≥n usando Nominatim (OpenStreetMap) - funci√≥n original mantenida para compatibilidad
        async function geocodeAddress(address) {
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}&limit=5&addressdetails=1`);
                const data = await response.json();
                
                return data.map(item => ({
                    lat: parseFloat(item.lat),
                    lng: parseFloat(item.lon),
                    display_name: item.display_name,
                    address: item.address
                }));
            } catch (error) {
                console.error('Error en geocodificaci√≥n:', error);
                return [];
            }
        }

        // Buscar lugares cercanos usando Overpass API (OpenStreetMap) - LIMITADO POR REGI√ìN
        async function findNearbyPlaces(lat, lng, radius = 2000) {
            try {
                // Primero obtener informaci√≥n de la regi√≥n del usuario
                const userRegion = await getUserRegionInfo(lat, lng);
                
                if (!userRegion.state || !userRegion.country) {
                    console.log('No se pudo determinar la regi√≥n del usuario');
                    return [];
                }
                
                // Query para buscar centros de reciclaje SOLO en la regi√≥n del usuario
                const overpassQuery = `
                    [out:json][timeout:25];
                    (
                        node["amenity"="recycling"](around:${radius},${lat},${lng});
                        node["shop"="second_hand"](around:${radius},${lat},${lng});
                        node["amenity"="waste_disposal"](around:${radius},${lat},${lng});
                        way["amenity"="recycling"](around:${radius},${lat},${lng});
                        way["shop"="second_hand"](around:${radius},${lat},${lng});
                    );
                    out center meta;
                `;
                
                const response = await fetch('https://overpass-api.de/api/interpreter', {
                    method: 'POST',
                    body: overpassQuery
                });
                
                const data = await response.json();
                
                // Filtrar resultados para que est√©n SOLO en la misma regi√≥n/estado
                const filteredElements = [];
                
                for (const element of data.elements) {
                    const elementLat = element.lat || element.center?.lat;
                    const elementLng = element.lon || element.center?.lon;
                    
                    if (elementLat && elementLng) {
                        // Verificar que el lugar est√© en la misma regi√≥n
                        const placeRegion = await getUserRegionInfo(elementLat, elementLng);
                        
                        // Solo incluir si est√° en el mismo estado/regi√≥n
                        if (placeRegion.state && 
                            (placeRegion.state.toLowerCase() === userRegion.state.toLowerCase() ||
                             placeRegion.country.toLowerCase() === userRegion.country.toLowerCase())) {
                            
                            const distance = calculateDistance(lat, lng, elementLat, elementLng);
                            
                            // L√≠mite adicional de distancia (m√°ximo 50km)
                            if (distance <= 50) {
                                filteredElements.push({
                                    name: `‚ôªÔ∏è ${element.tags?.name || 'Centro de Reciclaje'}`,
                                    category: getCategoryFromTags(element.tags),
                                    address: formatAddress(element.tags),
                                    distance: `${distance.toFixed(1)} km`,
                                    rating: (Math.random() * 1.5 + 3.5).toFixed(1),
                                    reviews: Math.floor(Math.random() * 200 + 20),
                                    materials: getMaterialsFromTags(element.tags),
                                    lat: elementLat,
                                    lng: elementLng
                                });
                            }
                        }
                    }
                }
                
                return filteredElements;
                
            } catch (error) {
                console.error('Error buscando lugares cercanos:', error);
                return [];
            }
        }

        // Calcular distancia entre dos puntos (f√≥rmula de Haversine)
        function calculateDistance(lat1, lng1, lat2, lng2) {
            const R = 6371; // Radio de la Tierra en km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLng = (lng2 - lng1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                      Math.sin(dLng/2) * Math.sin(dLng/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        // Determinar categor√≠a basada en tags de OpenStreetMap
        function getCategoryFromTags(tags) {
            if (tags?.recycling_type?.includes('electronics') || tags?.shop === 'electronics') {
                return 'Electr√≥nicos';
            } else if (tags?.recycling_type?.includes('batteries')) {
                return 'Pilas';
            } else if (tags?.shop === 'second_hand' || tags?.recycling_type?.includes('clothes')) {
                return 'Textiles';
            } else if (tags?.recycling_type?.includes('paper')) {
                return 'Papel';
            } else if (tags?.recycling_type?.includes('plastic')) {
                return 'Pl√°sticos';
            }
            return 'Centro General';
        }

        // Formatear direcci√≥n desde tags
        function formatAddress(tags) {
            const parts = [];
            if (tags?.['addr:street']) parts.push(tags['addr:street']);
            if (tags?.['addr:housenumber']) parts.push(tags['addr:housenumber']);
            if (tags?.['addr:city']) parts.push(tags['addr:city']);
            
            return parts.length > 0 ? parts.join(', ') : 'Direcci√≥n no disponible';
        }

        // Obtener materiales desde tags
        function getMaterialsFromTags(tags) {
            const materials = [];
            if (tags?.recycling_type) {
                const types = tags.recycling_type.split(';');
                types.forEach(type => {
                    switch(type.trim()) {
                        case 'paper': materials.push('Papel'); break;
                        case 'plastic': materials.push('Pl√°stico'); break;
                        case 'glass': materials.push('Vidrio'); break;
                        case 'metal': materials.push('Metal'); break;
                        case 'electronics': materials.push('Electr√≥nicos'); break;
                        case 'batteries': materials.push('Pilas'); break;
                        case 'clothes': materials.push('Textiles'); break;
                    }
                });
            }
            return materials.length > 0 ? materials.join(', ') : 'Varios materiales';
        }

        async function getCurrentLocation() {
            showLoading();
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        
                        // Obtener informaci√≥n de la regi√≥n del usuario
                        const userRegion = await getUserRegionInfo(userLocation.lat, userLocation.lng);
                        console.log('Regi√≥n del usuario:', userRegion);
                        
                        // Centrar mapa en ubicaci√≥n del usuario
                        map.setView([userLocation.lat, userLocation.lng], 15);
                        
                        // Agregar marcador de usuario
                        if (userMarker) {
                            map.removeLayer(userMarker);
                        }
                        
                        const userIcon = L.divIcon({
                            html: `<div style="
                                background: linear-gradient(135deg, #ef4444, #dc2626);
                                width: 20px;
                                height: 20px;
                                border-radius: 50%;
                                border: 3px solid white;
                                box-shadow: 0 3px 10px rgba(0,0,0,0.3);
                                animation: pulse 2s infinite;
                            "></div>`,
                            className: 'user-marker',
                            iconSize: [20, 20],
                            iconAnchor: [10, 10]
                        });
                        
                        const locationText = userRegion.city ? 
                            `üìç Tu ubicaci√≥n en ${userRegion.city}, ${userRegion.state}` : 
                            `üìç Tu ubicaci√≥n en ${userRegion.state}, ${userRegion.country}`;
                        
                        userMarker = L.marker([userLocation.lat, userLocation.lng], { icon: userIcon })
                            .addTo(map)
                            .bindPopup(locationText)
                            .openPopup();
                        
                        // Buscar lugares reales cercanos SOLO en la regi√≥n del usuario
                        try {
                            const nearbyPlaces = await findNearbyPlaces(userLocation.lat, userLocation.lng);
                            
                            if (nearbyPlaces.length > 0) {
                                console.log(`Encontrados ${nearbyPlaces.length} lugares reales en tu regi√≥n`);
                                displayPlaces(nearbyPlaces);
                                addMarkersToMap(nearbyPlaces);
                                
                                // Ajustar vista para incluir todos los marcadores
                                const allMarkers = [...markers];
                                if (userMarker) allMarkers.push(userMarker);
                                const group = new L.featureGroup(allMarkers);
                                map.fitBounds(group.getBounds().pad(0.1));
                            } else {
                                console.log('No se encontraron lugares reales, generando datos locales simulados');
                                // Generar datos locales basados en la ubicaci√≥n real del usuario
                                const localPlaces = generateLocalPlacesData(userLocation.lat, userLocation.lng, userRegion);
                                
                                // Actualizar placesData con los datos locales generados
                                placesData.reciclaje = localPlaces;
                                placesData.electronico = localPlaces.filter(p => p.category === 'Electr√≥nicos');
                                placesData.pilas = localPlaces.filter(p => p.category === 'Pilas');
                                placesData.textiles = localPlaces.filter(p => p.category === 'Textiles');
                                placesData.papel = localPlaces.filter(p => p.category === 'Papel');
                                placesData.plastico = localPlaces.filter(p => p.category === 'Pl√°sticos');
                                
                                displayPlaces(localPlaces);
                                addMarkersToMap(localPlaces);
                            }
                        } catch (error) {
                            console.error('Error buscando lugares cercanos:', error);
                            // Generar datos locales como fallback
                            const localPlaces = generateLocalPlacesData(userLocation.lat, userLocation.lng, userRegion);
                            placesData.reciclaje = localPlaces;
                            displayPlaces(localPlaces);
                            addMarkersToMap(localPlaces);
                        }
                        
                        hideLoading();
                    },
                    async (error) => {
                        hideLoading();
                        console.error('Error obteniendo ubicaci√≥n:', error);
                        
                        // Mostrar mensaje de error espec√≠fico
                        const placesList = document.getElementById('placesList');
                        placesList.innerHTML = `
                            <div style="text-align: center; padding: 40px; background: rgba(239, 68, 68, 0.1); border-radius: 20px; border: 2px solid rgba(239, 68, 68, 0.3);">
                                <div style="font-size: 3rem; margin-bottom: 20px;">üìç</div>
                                <h3 style="color: #ef4444; margin-bottom: 15px;">No se pudo obtener tu ubicaci√≥n</h3>
                                <p style="color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                                    Para usar EcoMaps necesitas permitir el acceso a tu ubicaci√≥n.
                                    <br>Esto nos permite mostrarte solo centros de reciclaje en tu √°rea local.
                                </p>
                                <button class="btn btn-secondary" onclick="getCurrentLocation()" style="margin-top: 10px;">
                                    üìç Intentar Nuevamente
                                </button>
                            </div>
                        `;
                    }
                );
            } else {
                hideLoading();
                // Geolocalizaci√≥n no soportada
                const placesList = document.getElementById('placesList');
                placesList.innerHTML = `
                    <div style="text-align: center; padding: 40px; background: rgba(239, 68, 68, 0.1); border-radius: 20px; border: 2px solid rgba(239, 68, 68, 0.3);">
                        <div style="font-size: 3rem; margin-bottom: 20px;">‚ùå</div>
                        <h3 style="color: #ef4444; margin-bottom: 15px;">Geolocalizaci√≥n no soportada</h3>
                        <p style="color: rgba(255,255,255,0.8);">
                            Tu navegador no soporta geolocalizaci√≥n.
                            <br>EcoMaps requiere acceso a tu ubicaci√≥n para funcionar correctamente.
                        </p>
                    </div>
                `;
            }
        }

        function updateDistances() {
            // Simular c√°lculo de distancias basado en ubicaci√≥n del usuario
            // En una aplicaci√≥n real, usar√≠as una API de c√°lculo de distancias
            Object.keys(placesData).forEach(category => {
                placesData[category].forEach(place => {
                    if (userLocation) {
                        // C√°lculo simple de distancia (no es preciso, solo para demo)
                        const distance = Math.random() * 2 + 0.1; // Entre 0.1 y 2.1 km
                        place.distance = `${distance.toFixed(1)} km`;
                    }
                });
            });
        }

        function filterCategory(category) {
            currentCategory = category;
            
            document.querySelectorAll('.floating-btn-below').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            showLoading();
            setTimeout(() => {
                hideLoading();
                displayPlaces(placesData[category]);
                addMarkersToMap(placesData[category]);
                
                // Ajustar vista del mapa a los nuevos marcadores
                if (markers.length > 0) {
                    const group = new L.featureGroup(markers);
                    map.fitBounds(group.getBounds().pad(0.1));
                }
            }, 800);
        }

        function displayPlaces(places) {
            const placesList = document.getElementById('placesList');
            
            placesList.innerHTML = places.map((place, index) => `
                <div class="place-card" onclick="focusOnPlace(${index + 1})">
                    <div class="place-category">${place.category}</div>
                    <div class="place-name">${place.name}</div>
                    <div class="place-info">üìç ${place.address}</div>
                    <div class="place-distance">üìè ${place.distance} de distancia</div>
                    <div class="place-info">üóÇÔ∏è ${place.materials}</div>
                    <div class="place-info">‚≠ê ${place.rating} (${place.reviews} rese√±as)</div>
                    ${place.directions ? `<div class="place-info directions-info">üö∂‚Äç‚ôÇÔ∏è ${place.directions}</div>` : ''}
                </div>
            `).join('');
        }

        function focusOnPlace(placeIndex) {
            const currentPlaces = placesData[currentCategory];
            const place = currentPlaces[placeIndex - 1];
            
            if (place && markers[placeIndex - 1]) {
                // Centrar mapa en el lugar seleccionado
                map.setView([place.lat, place.lng], 16);
                
                // Abrir popup del marcador
                markers[placeIndex - 1].openPopup();
                
                // Scroll al mapa
                document.querySelector('.map-container').scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });
            }
        }

        function showLoading() {
            document.getElementById('loadingIndicator').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loadingIndicator').style.display = 'none';
        }

        function showTab(tabName) {
            // Cambiar contenido
            document.getElementById('lugaresContent').classList.toggle('hidden', tabName !== 'lugares');
            document.getElementById('ambienteContent').classList.toggle('hidden', tabName !== 'ambiente');
            
            // Mostrar bot√≥n de inicio solo en la secci√≥n de lugares
            const homeBtn = document.getElementById('homeBtn');
            homeBtn.style.display = tabName === 'lugares' ? 'block' : 'none';
            
            // Actualizar estado activo de las pesta√±as correctamente
            const lugaresTab = document.getElementById('lugaresTab');
            const ambienteTab = document.getElementById('ambienteTab');
            
            lugaresTab.classList.remove('active');
            ambienteTab.classList.remove('active');
            
            if (tabName === 'lugares') {
                lugaresTab.classList.add('active');
            } else if (tabName === 'ambiente') {
                ambienteTab.classList.add('active');
            }
        }

        function startApp() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            // Inicializar mapa cuando se abre la aplicaci√≥n
            setTimeout(() => {
                initMap();
            }, 100);
        }

        function goHome() {
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('welcomeScreen').classList.remove('hidden');
        }

        // Event listeners
        // Removed search input event listener

        // Funciones para mostrar mensajes informativos
        function showLocationRequiredMessage() {
            const placesList = document.getElementById('placesList');
            placesList.innerHTML = `
                <div style="text-align: center; padding: 40px; background: rgba(239, 68, 68, 0.1); border-radius: 20px; border: 2px solid rgba(239, 68, 68, 0.3);">
                    <div style="font-size: 3rem; margin-bottom: 20px;">üìç</div>
                    <h3 style="color: #ef4444; margin-bottom: 15px;">Ubicaci√≥n Requerida</h3>
                    <p style="color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                        Para realizar b√∫squedas, primero necesitas compartir tu ubicaci√≥n haciendo clic en "Mi Ubicaci√≥n"
                    </p>
                    <button class="btn btn-secondary" onclick="getCurrentLocation()" style="margin-top: 10px;">
                        üìç Compartir Mi Ubicaci√≥n
                    </button>
                </div>
            `;
        }

        function showNoResultsMessage(searchTerm) {
            const placesList = document.getElementById('placesList');
            placesList.innerHTML = `
                <div style="text-align: center; padding: 40px; background: rgba(251, 191, 36, 0.1); border-radius: 20px; border: 2px solid rgba(251, 191, 36, 0.3);">
                    <div style="font-size: 3rem; margin-bottom: 20px;">üîç</div>
                    <h3 style="color: #fbbf24; margin-bottom: 15px;">No se encontraron resultados</h3>
                    <p style="color: rgba(255,255,255,0.8);">
                        No se encontraron centros de reciclaje para "${searchTerm}" en tu √°rea local.
                        <br>Intenta con otro t√©rmino de b√∫squeda o explora las categor√≠as disponibles.
                    </p>
                </div>
            `;
        }

        function showOutOfRangeMessage(searchTerm) {
            const placesList = document.getElementById('placesList');
            placesList.innerHTML = `
                <div style="text-align: center; padding: 40px; background: rgba(168, 85, 247, 0.1); border-radius: 20px; border: 2px solid rgba(168, 85, 247, 0.3);">
                    <div style="font-size: 3rem; margin-bottom: 20px;">üó∫Ô∏è</div>
                    <h3 style="color: #a855f7; margin-bottom: 15px;">Fuera del √°rea local</h3>
                    <p style="color: rgba(255,255,255,0.8);">
                        "${searchTerm}" est√° fuera de tu √°rea local (m√°s de 50km).
                        <br>Las b√∫squedas est√°n limitadas a tu estado/regi√≥n para mostrarte lugares accesibles.
                    </p>
                </div>
            `;
        }

        function showErrorMessage() {
            const placesList = document.getElementById('placesList');
            placesList.innerHTML = `
                <div style="text-align: center; padding: 40px; background: rgba(239, 68, 68, 0.1); border-radius: 20px; border: 2px solid rgba(239, 68, 68, 0.3);">
                    <div style="font-size: 3rem; margin-bottom: 20px;">‚ö†Ô∏è</div>
                    <h3 style="color: #ef4444; margin-bottom: 15px;">Error en la b√∫squeda</h3>
                    <p style="color: rgba(255,255,255,0.8);">
                        Hubo un problema al realizar la b√∫squeda. Por favor, intenta nuevamente.
                    </p>
                </div>
            `;
        }

        // Inicializar con mensaje de ubicaci√≥n requerida
        showLocationRequiredMessage();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9901bb6026ff574f',t:'MTc2MDcyNDQwOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

